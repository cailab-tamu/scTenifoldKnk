FC <- FC[!grepl('Rpl|Rps|Rp[[:digit:]]+|Mt-',names(FC))]
kA <- fgseaMultilevel(mmuKEGG, FC)
View(kA)
kA <- fgseaMultilevel(mmuKEGG, FC, minSize = 10)
View(kA)
FC <- DE$avg_logFC
names(FC) <- toupper(rownames(DE))
#FC <- FC[DE$p_val_adj < 0.05]
FC <- FC[FC > 0]
FC <- FC[!grepl('Rpl|Rps|Rp[[:digit:]]+|Mt-',names(FC))]
kA <- fgseaMultilevel(mmuKEGG, FC, minSize = 10)
View(kA)
kA <- fgsea(mmuKEGG, FC, minSize = 10, nperm = 1e6)
View(kA)
# png('oList.png', width = 1500, height = 1000, res = 300)
# plot(compareLists(lZ,lFC, no.reverse = TRUE, alphas = c(0.005)))
# dev.off()
DE$avg_logFC > 0 & DE$p_val_adj < 0.05
# png('oList.png', width = 1500, height = 1000, res = 300)
# plot(compareLists(lZ,lFC, no.reverse = TRUE, alphas = c(0.005)))
# dev.off()
DE[DE$avg_logFC > 0 & DE$p_val_adj < 0.05,]
# png('oList.png', width = 1500, height = 1000, res = 300)
# plot(compareLists(lZ,lFC, no.reverse = TRUE, alphas = c(0.005)))
# dev.off()
rownames(DE[DE$avg_logFC > 0 & DE$p_val_adj < 0.05,])
# png('oList.png', width = 1500, height = 1000, res = 300)
# plot(compareLists(lZ,lFC, no.reverse = TRUE, alphas = c(0.005)))
# dev.off()
gListDE <- rownames(DE[DE$avg_logFC > 0 & DE$p_val_adj < 0.05,])
E <- enrichr(gListDE, c('KEGG_2019_Human', 'GO_Biological_Process_2018','GO_Cellular_Component_2018', 'GO_Molecular_Function_2018','BioPlanet_2019', 'WikiPathways_2019_Human', 'Reactome_2016'))
E <- do.call(rbind.data.frame, E)
E <- E[E$Adjusted.P.value < fdrThreshold,]
E <- E[E$Adjusted.P.value < ]
E <- E[E$Adjusted.P.value < 0.05]
E <- E[order(E$Adjusted.P.value),]
E <- enrichr(gListDE, c('KEGG_2019_Human', 'GO_Biological_Process_2018','GO_Cellular_Component_2018', 'GO_Molecular_Function_2018','BioPlanet_2019', 'WikiPathways_2019_Human', 'Reactome_2016'))
E <- do.call(rbind.data.frame, E)
E <- E[E$Adjusted.P.value < 0.05]
View(E)
E <- E[E$Adjusted.P.value < 0.05,]
E <- E[order(E$Adjusted.P.value),]
View(E)
View(E)
set.seed(1)
kA <- fgsea(mmuKEGG, FC, minSize = 10, nperm = 1e6)
set.seed(1)
kB <- fgsea(BIOP, FC, minSize = 10, nperm = 1e6)
set.seed(1)
kC <- fgsea(WP, FC, minSize = 10, nperm = 1e6)
set.seed(1)
kD <- fgsea(REACTOME, FC, minSize = 10, nperm = 1e6)
set.seed(1)
kE <- fgsea(goBP, FC, minSize = 10, nperm = 1e6)
k <- rbind(kA,kB,kC,kD,kE)
k <- k[k$padj < 0.05,]
View(k)
FC <- DE$avg_logFC
names(FC) <- toupper(rownames(DE))
#FC <- FC[DE$p_val_adj < 0.05]
#FC <- FC[FC > 0]
FC <- FC[!grepl('Rpl|Rps|Rp[[:digit:]]+|Mt-',names(FC))]
set.seed(1)
kA <- fgsea(mmuKEGG, FC, minSize = 10, nperm = 1e6)
set.seed(1)
kB <- fgsea(BIOP, FC, minSize = 10, nperm = 1e6)
set.seed(1)
kC <- fgsea(WP, FC, minSize = 10, nperm = 1e6)
set.seed(1)
kD <- fgsea(REACTOME, FC, minSize = 10, nperm = 1e6)
set.seed(1)
kE <- fgsea(goBP, FC, minSize = 10, nperm = 1e6)
k <- rbind(kA,kB,kC,kD,kE)
k <- k[k$padj < 0.05,]
View(k)
allDB <- c(mmuKEGG, BIOP, WP, REACTOME, goBP)
FC <- DE$avg_logFC
names(FC) <- toupper(rownames(DE))
#FC <- FC[DE$p_val_adj < 0.05]
#FC <- FC[FC > 0]
FC <- abs(FC)
FC <- FC[!grepl('Rpl|Rps|Rp[[:digit:]]+|Mt-',names(FC))]
set.seed(1)
kA <- fgsea(mmuKEGG, FC, minSize = 10, nperm = 1e6)
set.seed(1)
kB <- fgsea(BIOP, FC, minSize = 10, nperm = 1e6)
set.seed(1)
kC <- fgsea(WP, FC, minSize = 10, nperm = 1e6)
set.seed(1)
kD <- fgsea(REACTOME, FC, minSize = 10, nperm = 1e6)
set.seed(1)
kE <- fgsea(goBP, FC, minSize = 10, nperm = 1e6)
k <- rbind(kA,kB,kC,kD,kE)
k <- k[k$padj < 0.05,]
View(k)
allDB <- c(mmuKEGG, BIOP, WP, REACTOME, goBP)
FC <- DE$avg_logFC
names(FC) <- toupper(rownames(DE))
#FC <- FC[DE$p_val_adj < 0.05]
FC <- FC[FC > 0]
FC <- FC[!grepl('Rpl|Rps|Rp[[:digit:]]+|Mt-',names(FC))]
set.seed(1)
kA <- fgsea(mmuKEGG, FC, minSize = 10, nperm = 1e6)
set.seed(1)
kB <- fgsea(BIOP, FC, minSize = 10, nperm = 1e6)
set.seed(1)
kC <- fgsea(WP, FC, minSize = 10, nperm = 1e6)
set.seed(1)
kD <- fgsea(REACTOME, FC, minSize = 10, nperm = 1e6)
set.seed(1)
kE <- fgsea(goBP, FC, minSize = 10, nperm = 1e6)
k <- rbind(kA,kB,kC,kD,kE)
k <- k[k$padj < 0.05,]
View(k)
set.seed(1)
kA <- fgsea(mmuKEGG, FC, nperm = 1e6)
set.seed(1)
kB <- fgsea(BIOP, FC, nperm = 1e6)
set.seed(1)
kC <- fgsea(WP, FC, nperm = 1e6)
set.seed(1)
kD <- fgsea(REACTOME, FC, nperm = 1e6)
set.seed(1)
kE <- fgsea(goBP, FC, nperm = 1e6)
k <- rbind(kA,kB,kC,kD,kE)
k <- k[k$padj < 0.05,]
View(k)
plotEnrichment(mmuKEGG$`Insulin secretion`, FC)
k$pathway %in% 'Insulin secretion'
k[k$pathway %in% 'Insulin secretion',]$NES
NES <- k[k$pathway %in% 'Insulin secretion',]$NES
FDR <- k[k$pathway %in% 'Insulin secretion',]$padj
plotEnrichment(mmuKEGG$`Insulin secretion`, FC)
library(ggplot2)
plotEnrichment(mmuKEGG$`Insulin secretion`, FC) + labs(title = 'Insulin secretion')
plotEnrichment(mmuKEGG$`Insulin secretion`, FC) + labs(title = 'Insulin secretion', subtitle = paste0('NES: ', NES, '| FDR = ', FDR))
NES <- round(k[k$pathway %in% 'Insulin secretion',]$NES,2)
FDR <- formatC(k[k$pathway %in% 'Insulin secretion',]$padj, digits = 2, mode = 'e')
FDR <- formatC(as.character(k[k$pathway %in% 'Insulin secretion',]$padj), digits = 2, mode = 'e')
k[k$pathway %in% 'Insulin secretion',]$padj
formatC(k[k$pathway %in% 'Insulin secretion',]$padj)
formatC(k[k$pathway %in% 'Insulin secretion',]$padj, format = 'e')
formatC(k[k$pathway %in% 'Insulin secretion',]$padj, format = 'e', digits = 2)
FDR <- formatC(k[k$pathway %in% 'Insulin secretion',]$padj, format = 'e', digits = 2)
plotEnrichment(mmuKEGG$`Insulin secretion`, FC) + labs(title = 'Insulin secretion', subtitle = paste0('NES: ', NES, '| FDR = ', FDR))
plotEnrichment(mmuKEGG$`Insulin secretion`, FC) + labs(title = 'Insulin secretion', subtitle = paste0('NES= ', NES, ', FDR = ', FDR))
plotEnrichment(mmuKEGG$`Insulin secretion`, FC) + xlab('Gene rank') + ylab('Enrichment Score') +labs(title = 'Insulin secretion', subtitle = paste0('NES= ', NES, ', FDR = ', FDR))
plotEnrichment(mmuKEGG$`Insulin secretion`, FC) +
xlab('Gene rank') +
ylab('Enrichment Score') +
labs(title = 'Insulin secretion', subtitle = paste0('NES= ', NES, ', FDR = ', FDR))
png('gsea1_Malat1.png', width = 1000, height = 1000, res = 300)
NES <- round(k[k$pathway %in% 'Insulin secretion',]$NES,2)
FDR <- formatC(k[k$pathway %in% 'Insulin secretion',]$padj, format = 'e', digits = 2)
plotEnrichment(mmuKEGG$`Insulin secretion`, FC) +
xlab('Gene rank') +
ylab('Enrichment Score') +
labs(title = 'Insulin secretion', subtitle = paste0('NES= ', NES, ', FDR = ', FDR))
dev.off()
View(k)
NES <- round(k[k$pathway %in% 'cellular respiration (GO:0045333)',]$NES,2)
FDR <- formatC(k[k$pathway %in% 'cellular respiration (GO:0045333)',]$padj, format = 'e', digits = 2)
plotEnrichment(mmuKEGG$`cellular respiration (GO:0045333)`, FC) +
xlab('Gene rank') +
ylab('Enrichment Score') +
labs(title = 'Cellular Respiration (GO:0045333)', subtitle = paste0('NES= ', NES, ', FDR = ', FDR))
plotEnrichment(goBP$`cellular respiration (GO:0045333)`, FC) +
xlab('Gene rank') +
ylab('Enrichment Score') +
labs(title = 'Cellular Respiration (GO:0045333)', subtitle = paste0('NES= ', NES, ', FDR = ', FDR))
png('gsea1_Malat2.png', width = 1000, height = 1000, res = 300)
NES <- round(k[k$pathway %in% 'cellular respiration (GO:0045333)',]$NES,2)
FDR <- formatC(k[k$pathway %in% 'cellular respiration (GO:0045333)',]$padj, format = 'e', digits = 2)
plotEnrichment(goBP$`cellular respiration (GO:0045333)`, FC) +
xlab('Gene rank') +
ylab('Enrichment Score') +
labs(title = 'Cellular Respiration (GO:0045333)', subtitle = paste0('NES= ', NES, ', FDR = ', FDR))
dev.off()
png('gsea1_Malat1.png', width = 1000, height = 1000, res = 300)
NES <- round(k[k$pathway %in% 'Insulin secretion',]$NES,2)
FDR <- formatC(k[k$pathway %in% 'Insulin secretion',]$padj, format = 'e', digits = 2)
plotEnrichment(mmuKEGG$`Insulin secretion`, FC) +
xlab('Gene rank') +
ylab('Enrichment Score') +
labs(title = 'Insulin secretion', subtitle = paste0('NES= ', NES, ', FDR = ', FDR))
dev.off()
png('gsea2_Malat1.png', width = 1000, height = 1000, res = 300)
NES <- round(k[k$pathway %in% 'cellular respiration (GO:0045333)',]$NES,2)
FDR <- formatC(k[k$pathway %in% 'cellular respiration (GO:0045333)',]$padj, format = 'e', digits = 2)
plotEnrichment(goBP$`cellular respiration (GO:0045333)`, FC) +
xlab('Gene rank') +
ylab('Enrichment Score') +
labs(title = 'Cellular Respiration (GO:0045333)', subtitle = paste0('NES= ', NES, ', FDR = ', FDR))
dev.off()
NES <- round(k[k$pathway %in% 'Circadian rhythm related genes WP3594',]$NES,2)
FDR <- formatC(k[k$pathway %in% 'Circadian rhythm related genes WP3594',]$padj, format = 'e', digits = 2)
png('gsea3_Malat1.png', width = 1000, height = 1000, res = 300)
NES <- round(k[k$pathway %in% 'Circadian rhythm related genes WP3594',]$NES,2)
FDR <- formatC(k[k$pathway %in% 'Circadian rhythm related genes WP3594',]$padj, format = 'e', digits = 2)
plotEnrichment(WP$`Circadian rhythm related genes WP3594`, FC) +
xlab('Gene rank') +
ylab('Enrichment Score') +
labs(title = 'Circadian rhythm related genes', subtitle = paste0('NES= ', NES, ', FDR = ', FDR))
dev.off()
plotEnrichment(WP$`Circadian rhythm related genes WP3594`, FC) +
xlab('Gene rank') +
ylab('Enrichment Score') +
theme(plot.title = element_text(face = 2))
plotEnrichment(WP$`Circadian rhythm related genes WP3594`, FC) +
xlab('Gene rank') +
ylab('Enrichment Score') +
theme(plot.title = element_text(face = 2)) +
labs(title = 'Circadian rhythm related genes', subtitle = paste0('NES= ', NES, ', FDR = ', FDR))
png('gsea3_Malat1.png', width = 1000, height = 1000, res = 300)
NES <- round(k[k$pathway %in% 'Circadian rhythm related genes WP3594',]$NES,2)
FDR <- formatC(k[k$pathway %in% 'Circadian rhythm related genes WP3594',]$padj, format = 'e', digits = 2)
plotEnrichment(WP$`Circadian rhythm related genes WP3594`, FC) +
xlab('Gene rank') +
ylab('Enrichment Score') +
theme(plot.title = element_text(face = 2)) +
labs(title = 'Circadian rhythm related genes', subtitle = paste0('NES= ', NES, ', FDR = ', FDR))
dev.off()
DR$gene[DR$p.adj < 0.05]
writeLines(DR$gene[DR$p.adj < 0.05])
png('gsea1_Malat1.png', width = 1000, height = 1000, res = 300)
NES <- round(k[k$pathway %in% 'Insulin secretion',]$NES,2)
FDR <- formatC(k[k$pathway %in% 'Insulin secretion',]$padj, format = 'e', digits = 2)
plotEnrichment(mmuKEGG$`Insulin secretion`, FC) +
xlab('Gene rank') +
ylab('Enrichment Score') +
theme(plot.title = element_text(face = 2)) +
labs(title = 'Insulin secretion', subtitle = paste0('NES= ', NES, ', FDR = ', FDR))
dev.off()
png('gsea2_Malat1.png', width = 1000, height = 1000, res = 300)
NES <- round(k[k$pathway %in% 'cellular respiration (GO:0045333)',]$NES,2)
FDR <- formatC(k[k$pathway %in% 'cellular respiration (GO:0045333)',]$padj, format = 'e', digits = 2)
plotEnrichment(goBP$`cellular respiration (GO:0045333)`, FC) +
xlab('Gene rank') +
ylab('Enrichment Score') +
theme(plot.title = element_text(face = 2)) +
labs(title = 'Cellular Respiration (GO:0045333)', subtitle = paste0('NES= ', NES, ', FDR = ', FDR))
dev.off()
png('gsea3_Malat1.png', width = 1000, height = 1000, res = 300)
NES <- round(k[k$pathway %in% 'Circadian rhythm related genes WP3594',]$NES,2)
FDR <- formatC(k[k$pathway %in% 'Circadian rhythm related genes WP3594',]$padj, format = 'e', digits = 2)
plotEnrichment(WP$`Circadian rhythm related genes WP3594`, FC) +
xlab('Gene rank') +
ylab('Enrichment Score') +
theme(plot.title = element_text(face = 2)) +
labs(title = 'Circadian rhythm related genes', subtitle = paste0('NES= ', NES, ', FDR = ', FDR))
dev.off()
png('gsea2_Malat1.png', width = 1000, height = 1000, res = 300)
NES <- round(k[k$pathway %in% 'cellular respiration (GO:0045333)',]$NES,2)
FDR <- formatC(k[k$pathway %in% 'cellular respiration (GO:0045333)',]$padj, format = 'e', digits = 2)
plotEnrichment(goBP$`cellular respiration (GO:0045333)`, FC) +
xlab('Gene rank') +
ylab('Enrichment Score') +
theme(plot.title = element_text(face = 2)) +
labs(title = 'Cellular Respiration GO:0045333', subtitle = paste0('NES= ', NES, ', FDR = ', FDR))
dev.off()
DE$avg_logFC
data.frame(FC = DE$avg_logFC, P = DE$p_val_adj)
data.frame(FC = DE$avg_logFC, P = DE$p_val_adj, G = rownames(DE))
DF <- data.frame(FC = DE$avg_logFC, P = DE$p_val_adj, G = rownames(DE))
ggplot(DF, aes(FC,P))
DF <- data.frame(FC = DE$avg_logFC, P = -log10(DE$p_val_adj), G = rownames(DE))
ggplot(DF, aes(FC,P))
ggplot(DF, aes(FC,P)) + geom_point()
ggplot(DF, aes(FC,P)) + geom_point() + xlim(c(-1,1))
WT <- readMM('WT.mtx')
rownames(WT) <- readLines('genesWT.txt')
colnames(WT) <- readLines('barcodesWT.txt')
WT <- WT[!rownames(WT) %in% 'Malat1',]
KO <- readMM('KO.mtx')
rownames(KO) <- readLines('genesKO.txt')
colnames(KO) <- readLines('barcodesKO.txt')
KO <- KO[!rownames(KO) %in% 'Malat1',]
WT <- CreateSeuratObject(WT, project = 'WT')
KO <- CreateSeuratObject(KO, project = 'KO')
ALL <- merge(WT,KO)
ALL <- NormalizeData(ALL)
ALL <- ScaleData(ALL)
ALL <- FindVariableFeatures(ALL, verbose = FALSE)
ALL <- RunPCA(ALL, verbose = FALSE)
ALL <- RunHarmony(ALL, group.by.vars = 'orig.ident')
ALL <- RunUMAP(ALL, reduction = 'harmony', dims = 1:50, verbose = FALSE)
UMAPPlot(ALL)
DE <- FindMarkers(ALL, ident.1 = 'KO', ident.2 = 'WT', test.use = 'MAST', logfc.threshold = 0)
#### Volcano ####
DF <- data.frame(FC = DE$avg_logFC, P = -log10(DE$p_val_adj), G = rownames(DE))
ggplot(DF, aes(FC,P)) + geom_point() + xlim(c(-1,1))
WT <- readMM('WT.mtx')
rownames(WT) <- readLines('genesWT.txt')
colnames(WT) <- readLines('barcodesWT.txt')
#WT <- WT[!rownames(WT) %in% 'Malat1',]
KO <- readMM('KO.mtx')
rownames(KO) <- readLines('genesKO.txt')
colnames(KO) <- readLines('barcodesKO.txt')
#KO <- KO[!rownames(KO) %in% 'Malat1',]
WT <- CreateSeuratObject(WT, project = 'WT')
KO <- CreateSeuratObject(KO, project = 'KO')
ALL <- merge(WT,KO)
ALL <- NormalizeData(ALL)
ALL <- ScaleData(ALL)
ALL <- FindVariableFeatures(ALL, verbose = FALSE)
ALL <- RunPCA(ALL, verbose = FALSE)
ALL <- RunHarmony(ALL, group.by.vars = 'orig.ident')
ALL <- RunUMAP(ALL, reduction = 'harmony', dims = 1:50, verbose = FALSE)
UMAPPlot(ALL)
DE <- FindMarkers(ALL, ident.1 = 'KO', ident.2 = 'WT', test.use = 'MAST', logfc.threshold = 0)
#### Volcano ####
DF <- data.frame(FC = DE$avg_logFC, P = -log10(DE$p_val_adj), G = rownames(DE))
ggplot(DF, aes(FC,P)) + geom_point() + xlim(c(-1,1))
DE$p_val_adj < 0.05
DE$p_val_adj >= 0.05
DF$G[DE$p_val_adj >= 0.05] <- NA
#### Volcano ####
library(ggrepel)
ggplot(DF, aes(FC,P, label = G)) + geom_point() + xlim(c(-1,1))
ggplot(DF, aes(FC,P, label = G)) + geom_point() + xlim(c(-1,1)) + geom_text_repel()
4+4
dev.off
dev.off()
dev.off()
abs(DF$FC)
abs(DF$FC) > 0.25
sum(abs(DF$FC) > 0.25)
sum(abs(DF$FC) > 0.3)
abs(DF$FC) > 0.3
DF$G[abs(DF$FC) < 0.3]
DF$G[abs(DF$FC) < 0.3] <- NA
ggplot(DF, aes(FC,P, label = G)) + geom_point() + xlim(c(-1,1)) + geom_text_repel()
DF <- data.frame(FC = DE$avg_logFC, P = -log10(DE$p_val_adj), G = rownames(DE))
DF$G[DE$p_val_adj >= 0.05] <- NA
DF$G[abs(DF$FC) < 0.29] <- NA
ggplot(DF, aes(FC,P, label = G)) + geom_point() + xlim(c(-1,1)) + geom_text_repel()
ggplot(DF, aes(FC,P, label = G)) +
geom_point() +
xlim(c(-1,1)) +
geom_text_repel() +
theme_bw()
png('volcanoMalat1.png')
ggplot(DF, aes(FC,P, label = G)) +
geom_point() +
xlim(c(-1,1)) +
geom_text_repel() +
theme_bw()
dev.off()
png('volcanoMalat1.png', width = 2000, height = 2000, res = 300)
ggplot(DF, aes(FC,P, label = G)) +
geom_point() +
xlim(c(-1,1)) +
geom_text_repel() +
theme_bw()
dev.off()
png('volcanoMalat1.png', width = 2000, height = 1500, res = 300)
ggplot(DF, aes(FC,P, label = G)) +
geom_point() +
xlim(c(-1,1)) +
geom_text_repel() +
theme_bw()
dev.off()
FC <- DE$avg_logFC #* -log10(DE$p_val_adj)
DE$p_val_adj < 0.05
ifelse(DE$p_val_adj < 0.05, 'red', 'black')
gCol <- ifelse(DE$p_val_adj < 0.05, 'red', 'black')
ggplot(DF, aes(FC,P, label = G)) +
geom_point(col = gCol) +
xlim(c(-1,1)) +
geom_text_repel() +
theme_bw()
gCol <- ifelse(!is.na(DF$G), 'red', 'black')
ggplot(DF, aes(FC,P, label = G)) +
geom_point(col = gCol) +
xlim(c(-1,1)) +
geom_text_repel() +
theme_bw()
png('volcanoMalat1.png', width = 2000, height = 1500, res = 300)
ggplot(DF, aes(FC,P, label = G)) +
geom_point() +
xlim(c(-1,1)) +
geom_text_repel() +
theme_bw()
dev.off()
png('volcanoMalat1.png', width = 1500, height = 1500, res = 300)
ggplot(DF, aes(FC,P, label = G)) +
geom_point() +
xlim(c(-1,1)) +
geom_text_repel() +
theme_bw()
dev.off()
png('volcanoMalat1.png', width = 1500, height = 1500, res = 300)
ggplot(DF, aes(FC,P, label = G)) +
geom_point() +
xlim(c(-1,0.6)) +
geom_text_repel() +
theme_bw()
dev.off()
ggplot(DF, aes(FC,P, label = G)) +
geom_point() +
xlim(c(-1,0.75)) +
geom_text_repel() +
theme_bw()
ggplot(DF, aes(FC,P, label = G)) +
geom_point() +
xlim(c(-1,0.75)) +
geom_text_repel() +
theme_bw() + xlab('log[2]~Fold-Change')
ggplot(DF, aes(FC,P, label = G)) +
geom_point() +
xlim(c(-1,0.75)) +
geom_text_repel() +
theme_bw() + xlab(expression('log[2]~Fold-Change'))
ggplot(DF, aes(FC,P, label = G)) +
geom_point() +
xlim(c(-1,0.75)) +
geom_text_repel() +
theme_bw() + xlab(expression(log[2]~Fold-Change))
ggplot(DF, aes(FC,P, label = G)) +
geom_point() +
xlim(c(-1,0.75)) +
geom_text_repel() +
theme_bw() + xlab(expression(log[2]~(Fold-Change)))
ggplot(DF, aes(FC,P, label = G)) +
geom_point() +
xlim(c(-1,0.75)) +
geom_text_repel() +
theme_bw() +
xlab(expression(log[2]~(Fold-Change))) +
ylab(expression(-log[10]~P-value))
ggplot(DF, aes(FC,P, label = G)) +
geom_point() +
xlim(c(-1,0.75)) +
geom_text_repel() +
theme_bw() +
xlab(expression(log[2]~(Fold-Change))) +
ylab(expression(-log[10]~(P-value)))
densCols(DF[,1:2])
ggplot(DF, aes(FC,P, label = G)) +
geom_point(col = densCols(DF[,1:2])) +
xlim(c(-1,0.75)) +
geom_text_repel() +
theme_bw() +
xlab(expression(log[2]~(Fold-Change))) +
ylab(expression(-log[10]~(P-value)))
library(ggrepel)
DF <- data.frame(FC = DE$avg_logFC, P = -log10(DE$p_val_adj), G = rownames(DE))
DF$G[DE$p_val_adj >= 0.05] <- NA
DF$G[abs(DF$FC) < 0.29] <- NA
png('volcanoMalat1.png', width = 1500, height = 1500, res = 300)
ggplot(DF, aes(FC,P, label = G)) +
geom_point(col = densCols(DF[,1:2])) +
xlim(c(-1,0.75)) +
geom_text_repel() +
theme_bw() +
xlab(expression(log[2]~(Fold-Change))) +
ylab(expression(-log[10]~(P-value)))
dev.off()
gCol <- densCols(DF[,1:2])
gCol[!is.na(DF$G)]
DF <- data.frame(FC = DE$avg_logFC, P = -log10(DE$p_val_adj), G = rownames(DE))
DF$G[DE$p_val_adj >= 0.05] <- NA
DF$G[abs(DF$FC) < 0.29] <- NA
gCol <- densCols(DF[,1:2])
gCol[!is.na(DF$G)] <- 'red'
ggplot(DF, aes(FC,P, label = G)) +
geom_point(col = ) +
xlim(c(-1,0.75)) +
geom_text_repel() +
theme_bw() +
xlab(expression(log[2]~(Fold-Change))) +
ylab(expression(-log[10]~(P-value)))
ggplot(DF, aes(FC,P, label = G)) +
geom_point(col = gCol) +
xlim(c(-1,0.75)) +
geom_text_repel() +
theme_bw() +
xlab(expression(log[2]~(Fold-Change))) +
ylab(expression(-log[10]~(P-value)))
png('volcanoMalat1.png', width = 1500, height = 1500, res = 300)
ggplot(DF, aes(FC,P, label = G)) +
geom_point(col = gCol) +
xlim(c(-1,0.75)) +
geom_text_repel() +
theme_bw() +
xlab(expression(log[2]~(Fold-Change))) +
ylab(expression(-log[10]~(P-value)))
dev.off()
png('volcanoMalat1.png', width = 1200, height = 1200, res = 300)
ggplot(DF, aes(FC,P, label = G)) +
geom_point(col = gCol) +
xlim(c(-1,0.75)) +
geom_text_repel() +
theme_bw() +
xlab(expression(log[2]~(Fold-Change))) +
ylab(expression(-log[10]~(P-value)))
dev.off()
UMAPPlot(ALL)
UMAPPlot(ALL) + theme_bw()
UMAPPlot(ALL) + theme_bw() + xlab('UMAP 1') + ylab('UMAP 1')
png('umapMalat1.png', width = 1200, height = 1200, res = 300)
UMAPPlot(ALL) + theme_bw() + xlab('UMAP 1') + ylab('UMAP 1')
dev.off()
png('umapMalat1.png', width = 1500, height = 1200, res = 300)
UMAPPlot(ALL) + theme_bw() + xlab('UMAP 1') + ylab('UMAP 1')
dev.off()
png('umapMalat1.png', width = 0.7*1500, height = 0.7*1200, res = 300)
UMAPPlot(ALL) + theme_bw() + xlab('UMAP 1') + ylab('UMAP 1')
dev.off()
png('umapMalat1.png', width = 1500, height = 1200, res = 300)
UMAPPlot(ALL) + theme_bw() + xlab('UMAP 1') + ylab('UMAP 1')
dev.off()
